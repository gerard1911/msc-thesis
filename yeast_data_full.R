# Full Yeast Data
yeast.data.list = list()
yeast.time.dependent = list()
yeast.time.independent = list()
# Switch-on Data

# Create empty data frame
data.switch.on = as.data.frame(matrix(,ncol = 7,  nrow = 58))

# time variable
data.switch.on[,6] = c( c(seq(0,by=20,180)) , c(seq(0,by=20,280)) , c(seq(0,by=20,160)), c(seq(0,by=20,160)), c(seq(0,by=20,280)))

# SWI5
data.switch.on[,3] = c( 
c(0.007976657,0.029157281,0.078836088,0.016120050,0.035402621,0.041521432,0.023438109,0.043434944,0.063592481,0.067920929),
c(0.001395502,0.005208198,0.013368672,0.011841536,0.011438169,0.017701311,0.016345077,0.022718321,0.014528202,0.017337023,0.012516717,0.014278616,0.02012315,0.017701311,0.012387252),
c(0.006280086,0.021270533,0.020905118,0.031250000,0.004726539,0.037291742,0.032803646,0.025737219,0.037812315),
c(0.011010318,0.037421210,0.028458432,0.040246301,0.054598306,0.022718321,0.029462017,0.032240099,0.032017401),
c(0.010672190,0.025382887,0.016401823,0.015953314,0.021604865,0.013744517,0.014477938,0.014082038,0.021642335,0.015303442,0.018198962,0.01286861,0.012516717,0.010709241,0.007839623)
)

#CBF1
data.switch.on[,1] = c(
c(0.003412394,0.018010724,0.028261856,0.006777646,0.009226505,0.007139308,0.006434305,0.015040538,0.011048543,0.071793647),
c(0.003582047,0.002980975,0.002174652,0.004487103,0.006280086,0.005601388,0.007839623,0.013003105,0.020545981,0.018198962,0.017039183,0.025826572,0.01991501,0.030500993,0.032352029),
c(0.004661468,0.004842608,0.004304317,0.006872258,0.022561394,0.015250496,0.013984767,0.018581361,0.025033434),
c(0.005758864,0.004186615,0.00401607,0.004661468,0.007839623,0.008032139,0.007704943,0.017886315,0.02351948),
c(0.00489322,0.004534,0.001803481,0.003460029,0.003799433,0.004759415,0.006707542,0.01175974,0.013936383,0.01286861,0.022561394,0.019709022,0.016862941,0.01751822,0.011882647)
)

#GAL4
data.switch.on[,2] = c(
c(0.030500993,0.047202268,0.033031814,0.014988502,0.018325546,0.014731008,0.014680043,0.015145153,0.026737345,0.021196943),
c(0.010972226,0.020193013,0.009162773,0.012048522,0.011010318,0.010783729,0.010026765,0.01067219,0.012048522,0.009923055,0.010635267,0.010858736,0.00794906,0.01020203,0.011319861),
c(0.021642335,0.015463385,0.013696964,0.018010724,0.006684336,0.010709241,0.011241669,0.007139308,0.015463385),
c(0.03901033,0.018775563,0.009322935,0.010858736,0.017762765,0.0078125,0.007213924,0.009957505,0.008974206),
c(0.059954007,0.03577263,0.013276328,0.011398596,0.010934265,0.008974206,0.006280086,0.005819053,0.010934265,0.007065464,0.00951883,0.007016659,0.008257953,0.006066163,0.005582008)
)

#GAL80
data.switch.on[,4] = c(
c(0.016232173,0.029769937,0.010525262,0.005448217,0.012216713,0.01457864,0.013984767,0.009355302,0.004143311,0.023930594),
c(0.011202775,0.010026765,0.004128977,0.005299236,0.005048253,0.009387782,0.005262631,0.00638986,0.009651708,0.009067999,0.008490116,0.005920768,0.008638521,0.00786684,0.009923055),
c(0.020905118,0.01147788,0.007494251,0.006456643,0.006003419,0.008286623,0.006323767,0.007598867,0.01277972),
c(0.023357020,0.013602353,0.006546774,0.007188966,0.009453079,0.006777646,0.007238969,0.010972226,0.010561803),
c(0.038740866,0.055168937,0.01020203,0.006323767,0.009702014,0.007365504,0.005317633,0.00567958,0.011048543,0.005543451,0.010598471,0.008881383,0.008116087,0.007041019,0.007416735)
)

#ASH1
data.switch.on[,5] = c(
c(0.006872258,0.020832792,0.021196943,0.017762765,0.040246301,0.021944451,0.048866853,0.045594386,0.023195681,0.036778336),
c(0.006456643,0.003974530,0.006066163,0.008519592,0.012603777,0.010272990,0.021792870,0.026096497,0.034794426,0.020617311,0.020905118,0.007041019,0.020263118,0.026369244,0.011923900),
c(0.010635267,0.009820417,0.020404059,0.024348893,0.008116087,0.026187098,0.024013675,0.018517075,0.040949794),
c(0.013508394,0.007758535,0.019037660,0.023195681,0.034434535,0.026369244,0.023683071,0.024518253,0.043134917),
c(0.022250784,0.011398596,0.011517728,0.016515907,0.026232516,0.018840747,0.018389168,0.016288528,0.022876339,0.013415085,0.022405551,0.020474897,0.017277041,0.016921485,0.013093549)
)

# Class
data.switch.on[,7] = rep('on', 58)


# Switch-off data

# Create empty dataframe
data.switch.off = as.data.frame(matrix(,ncol = 7,  nrow = 76))

# time
data.switch.off[,6] = c( c(seq(0,by=10,170)) , c(seq(0,by=10,170)) , c(seq(0,by=10,190)), c(seq(0,by=10,190)))

#SWI5
data.switch.off[,3] = c(
c(0.011477880,0.014988502,0.008004350,0.007921558,0.007442484,0.006389860,0.004613253,0.005467132,0.027776334,0.005154328,0.004364403,0.003606962,0.003412394,0.004394760,0.002771725,0.013602353,0.013888167,0.017701311),
c(0.013888167,0.020123150,0.006172198,0.012132326,0.006968192,0.008431471,0.005391865,0.005819053,0.008728806,0.006434305,0.004487103,0.004549741,0.006456643,0.006615198,0.012958118,0.011882647,0.009923055,0.024348893),
c(0.113222101,0.017518220,0.012799602,0.008912217,0.010096506,0.008698606,0.009226505,0.007625248,0.005640348,0.004910208,0.006150844,0.006968192,0.006280086,0.006345722,0.005190179,0.005370634,0.005249081,0.005250151,0.004703427,0.006492836),
c(0.165511114,0.028359974,0.008134861,0.017886315,0.010897360,0.014482816,0.010777815,0.009359262,0.012679569,0.006355935,0.005679580,0.022097087,0.005798920,0.006968192,0.006896117,0.006501553,0.007442484,0.004289425,0.007830152,0.005290011)
)

#CBF1
data.switch.off[,1] = c(
c(0.009854511,0.003484096,0.035772630,0.025471010,0.030081076,0.040246301,0.038075321,0.033031814,0.006569503,0.022328033,0.020688889,0.016746460,0.013840117,0.010344445,0.007340021,0.008344261,0.018135999,0.011010318),
c(0.013840117,0.006920059,0.040526236,0.037034149,0.051653145,0.048697786,0.070316155,0.031796240,0.040949794,0.022955760,0.014833471,0.019170078,0.020404059,0.016515907,0.006730829,0.014936646,0.011882647,0.005317633),
c(0.079102796,0.056328154,0.070805243,0.056523711,0.052012421,0.071793647,0.072042897,0.072543995,0.069588851,0.039830020,0.064480199,0.056523711,0.049549009,0.030081076,0.035648866,0.032302184,0.023418395,0.017003517,0.018432729,0.015776549),
c(0.064704058,0.045279442,0.058541945,0.070293203,0.059021279,0.057780080,0.078684403,0.083666709,0.061675059,0.055782078,0.043284671,0.042985682,0.040107059,0.036146506,0.026737345,0.020474897,0.017277041,0.009005362,0.011084477,0.012118542)
)

#GAL4
data.switch.off[,2] = c(
c(0.006546774,0.024013675,0.004425328,0.004456108,0.004961527,0.004597292,0.008144264,0.006707542,0.011010318,0.007520269,0.006944083,0.006638164,0.007546378,0.007785471,0.007065464,0.012958118,0.016458766,0.014179987),
c(0.010166733,0.018010724,0.007468323,0.006661210,0.004910208,0.004893220,0.005410584,0.008286623,0.008789519,0.009854511,0.003228322,0.004349303,0.007625248,0.006730829,0.006592311,0.008943158,0.008820034,0.010452559),
c(0.026093866,0.011678510,0.009752582,0.008638521,0.010026765,0.012473412,0.012735505,0.013792234,0.011800567,0.010166733,0.008649758,0.008868904,0.009323650,0.008991409,0.011408331,0.009042704,0.009037481,0.009954803,0.010413801,0.010283406),
c(0.039968299,0.013912254,0.010237448,0.011882647,0.013589465,0.018234109,0.012447027,0.014149683,0.017958510,0.018919411,0.010561803,0.010202030,0.009012784,0.007651721,0.010380358,0.010672190,0.011241669,0.005354620,0.013708124,0.012055155)
)

# GAL 80
data.switch.off[,4] = c(
c(0.021642335,0.022173802,0.015733680,0.009226505,0.008144264,0.011048543,0.009453079,0.006215129,0.011882647,0.008519592,0.006730829,0.003140043,0.005879870,0.008286623,0.006024261,0.014082038,0.012647535,0.007041019),
c(0.028359974,0.009585039,0.012259127,0.006501553,0.009551877,0.008229383,0.004693891,0.019505165,0.005013382,0.017217267,0.002714684,0.011477880,0.004613253,0.003557304,0.004143311,0.007812500,0.016345077,0.012006837),
c(0.023016312,0.016980232,0.016120050,0.016688522,0.019103754,0.017157700,0.013602353,0.011882647,0.013230396,0.010821168,0.009863921,0.012580294,0.013049660,0.008772973,0.009669443,0.008004350,0.006920059,0.010688065,0.009106624,0.011562002),
c(0.016804600,0.018325546,0.021626208,0.026071908,0.021334839,0.021305763,0.014640869,0.009693813,0.016667049,0.020213683,0.014082038,0.011280697,0.011638105,0.014082038,0.014427849,0.013888167,0.013555292,0.007365504,0.011898817,0.014171797)
)

#ASH1
data.switch.off[,5] = c(
c(0.055360470,0.008974206,0.016630784,0.020832792,0.027393929,0.015733680,0.010821168,0.008608634,0.039554894,0.010452559,0.006172198,0.007546378,0.006777646,0.006215129,0.008820034,0.010525262,0.011280697,0.009923055),
c(0.082183923,0.006456643,0.024013675,0.015409886,0.011359160,0.020474897,0.005920768,0.010972226,0.007442484,0.018010724,0.007921558,0.007468323,0.004425328,0.003682752,0.001580942,0.010934265,0.010821168,0.022639721),
c(0.153773254,0.078020659,0.060694033,0.044966674,0.063592481,0.067685940,0.045752678,0.028855697,0.048361406,0.018775563,0.021549041,0.018341698,0.014479083,0.010670207,0.009298064,0.005920768,0.012691444,0.017824433,0.014936646,0.008759110),
c(0.121581868,0.078291527,0.074414883,0.066981338,0.087641805,0.083425110,0.076176747,0.050351934,0.041073765,0.028743877,0.018010724,0.025559439,0.014731008,0.014578640,0.012174447,0.008638521,0.010598471,0.011398596,0.009474945,0.013870759)
)

#Class
data.switch.off[,7]= c(rep('off',times=length(data.switch.off[,1])))

# Create full data frame witch classes and time.
yeast.data = as.data.frame(rbind(data.switch.on,data.switch.off))
colnames(yeast.data) <- c('CBF1','GAL4','SWI5','GAL80','ASH1','time','switch')
yeast.data.list$full.data = yeast.data

# Create dataframes where gen_i(t+1) ~ gen_j(t)
yeast.time.dependent = list()
for(i in 1:5){
	temp.time = yeast.data[,6]
	temp.data = yeast.data
	temp.resp = yeast.data[,i]
	temp.resp = temp.resp[temp.time!=0]
	temp.class = yeast.data[,7]
	temp.class = temp.class[temp.time!=0]
	temp.time = temp.time[temp.time!=0]
	temp.exp = yeast.data[,-c(i,6,7)]
	temp.exp = temp.exp[c(c(1:9),c(11:24),c(26:33),c(35:42),c(44:57),c(59:75),c(77:93),c(95:113),c(115:133)),]
	temp.data = cbind(temp.resp,temp.exp,temp.time,temp.class)
	colnames(temp.data)[1] = colnames(yeast.data[i])	
	colnames(temp.data)[6] = colnames(yeast.data)[6]
	colnames(temp.data)[7] = colnames(yeast.data)[7]

	yeast.time.dependent[[i]] = temp.data
	}
# Full data frame with measurements.
	yeast.time.dependent[[6]] = yeast.data
	
# Data list
yeast.data.list$full.cbf1 = yeast.time.dependent[[1]]
yeast.data.list$full.gal4 = yeast.time.dependent[[2]]
yeast.data.list$full.swi5 = yeast.time.dependent[[3]]
yeast.data.list$full.gal80 = yeast.time.dependent[[4]]
yeast.data.list$full.ash1 = yeast.time.dependent[[5]]

#______________________________________________________________________

# Determine maximum/minimum/average observartion
data = yeast.time.dependent[[6]]
data.on = data[data[,7]=='on',]
data.off = data[data[,7]=='off',]
max.yeast.on = as.data.frame(matrix(,nrow=15,ncol=7))
min.yeast.on = as.data.frame(matrix(,nrow=15,ncol=7))
average.yeast.on =  as.data.frame(matrix(,nrow=15,ncol=7))
average.yeast.off =  as.data.frame(matrix(,nrow=20,ncol=7))
max.yeast.off = as.data.frame(matrix(,nrow=20,ncol=7))
min.yeast.off = as.data.frame(matrix(,nrow=20,ncol=7))
max.yeast.on[,6] = seq(min(data.on[,6]),by=20,max(data.on[,6]))
max.yeast.on[,7] = 'on'
min.yeast.on[,6]= seq(min(data.on[,6]),by=20,max(data.on[,6]))
min.yeast.on[,7] = 'on'
max.yeast.off[,6] = seq(min(data.off[,6]),by=10,max(data.off[,6]))
max.yeast.off[,7] = 'off'
min.yeast.off[,6]= seq(min(data.off[,6]),by=10,max(data.off[,6]))
min.yeast.off[,7] = 'off'
average.yeast.on[,6]= seq(min(data.on[,6]),by=20,max(data.on[,6]))
average.yeast.on[,7] = 'on'
average.yeast.off[,6]= seq(min(data.off[,6]),by=10,max(data.off[,6]))
average.yeast.off[,7] = 'off'

# Determine average of activity per time point.
k = 1
for(time in seq(min(data.on[,6]),by=20,max(data.on[,6]))){
  for(i in 1:5){
    maxob.on = max(data.on[data.on[,6]==time,i])
    average.yeast.on[k,i] = mean(data.on[data.on[,6]==time,i])
    minob.on = min(data.on[data.on[,6]==time,i])
    max.yeast.on[k,i] = maxob.on
    min.yeast.on[k,i] = minob.on
  }
  k = k + 1
}

# Create max/min data frame.
k = 1
for(time in seq(min(data.off[,6]),by=10,max(data.off[,6]))){
  for(i in 1:5){
    maxob.off = max(data.off[data.off[,6]==time,i])
    minob.off = min(data.off[data.off[,6]==time,i])
    average.yeast.off[k,i] = mean(data.off[data.off[,6]==time,i])
    max.yeast.off[k,i] = maxob.off
    min.yeast.off[k,i] = minob.off
  }
  k = k + 1
}
max.yeast= rbind(max.yeast.on,max.yeast.off)
min.yeast= rbind(min.yeast.on,min.yeast.off)
average.yeast= rbind(average.yeast.on,average.yeast.off)
colnames(max.yeast) = c('CBF1','GAL4','SWI5','GAL80','ASH1','time', 'switch')
colnames(min.yeast) = c('CBF1','GAL4','SWI5','GAL80','ASH1','time', 'switch')
colnames(average.yeast) = c('CBF1','GAL4','SWI5','GAL80','ASH1','time', 'switch')


# Last enties time dependent list
yeast.time.dependent[[7]] = max.yeast
yeast.time.dependent[[8]] = min.yeast
yeast.time.dependent[[9]] = average.yeast

# Putting data in ordered list.
yeast.data.list$average.data = average.yeast
yeast.data.list$max.data = max.yeast
yeast.data.list$min.data = min.yeast

average.data = average.yeast
average.switch.off = average.data[average.data[,7]=='off',]
average.switch.on = average.data[average.data[,7]=='on',]


# Create dataframes where gen_i(t+1) ~ gen_j(t)
for(i in 1:5){
  # Re-arrange data
  X1 = average.switch.off
  resp = colnames(X1)[i]
  y1 = X1[2:20,i]
  X1 = X1[1:19,-i]
  X1 = cbind(y1,X1)
  colnames(X1)[1] = resp
  
  X2 = average.switch.on
  resp = colnames(X2)[i]
  y2 = X2[2:15,i]
  X2 = X2[1:14,-i]
  X2 = cbind(y2,X2)
  colnames(X2)[1] = resp
  
  yeast.time.dependent[[9+i]] = rbind(X2,X1)
  
}

# Create dataframes where gen_i(t) ~ gen_j(t)
for(i in 1:5){
  # Re-arrange data
  X1 = average.switch.off
  resp = colnames(X1)[i]
  y1 = X1[,i]
  X1 = X1[,-i]
  X1 = cbind(y1,X1)
  colnames(X1)[1] = resp
  
  X2 = average.switch.on
  resp = colnames(X2)[i]
  y2 = X2[,i]
  X2 = X2[,-i]
  X2 = cbind(y2,X2)
  colnames(X2)[1] = resp
  
  yeast.time.independent[[i]] = rbind(X2,X1)
  
}


#Full measurements in ordered list.
yeast.time.dependent[[15]] = average.data
yeast.data.list$average.data = average.data
yeast.data.list$average.cbf1 = yeast.time.dependent[[10]]
yeast.data.list$average.gal4 = yeast.time.dependent[[11]]
yeast.data.list$average.swi5 = yeast.time.dependent[[12]]
yeast.data.list$average.gal80 = yeast.time.dependent[[13]]
yeast.data.list$average.ash1 = yeast.time.dependent[[14]]


#______________________________________________________________________________________
# RECORDERD AVERAGE YEAST-DATA (CORRUPT!!)

# Switch-On data
average.switch.on = as.data.frame(matrix(,nrow= 15,ncol = 6))

#CBF1
average.switch.on[,1] = c(0.0045, 0.0069, 0.0081, 0.0053, 0.01, 0.0082, 0.0085, 0.0153, 0.0188, 0.0339, 0.0251, 0.0222, 0.0194, 0.02, 0.0208)

#GAL4
average.switch.on[,2] = c(0.0324, 0.0275, 0.0157, 0.0134, 0.0125, 0.0106, 0.0098, 0.0097, 0.0148, 0.0112, 0.0105, 0.008, 0.0093, 0.0071, 0.01)

#SWI5
average.switch.on[,3] = c(0.0075, 0.0237, 0.0316, 0.0231, 0.0298, 0.0266, 0.0233, 0.0276, 0.0339, 0.0366, 0.0285, 0.0232, 0.0228, 0.021, 0.0205)

#GAL80
average.switch.on[,4] = c(0.0221, 0.0240, 0.0078, 0.0061,  0.0085, 0.0093, 0.0076, 0.0080, 0.0096, 0.0119, 0.0084, 0.0067, 0.0059, 0.0048, 0.0084)
#ASH1

average.switch.on[,5] = c(0.0120, 0.0108, 0.0156, 0.0181, 0.0243, 0.0207, 0.0274, 0.0262, 0.0330, 0.0256, 0.0273, 0.0254, 0.0222, 0.0218, 0.0170)

#time
average.switch.on[,6] = c(0:14)*20

#classes
average.switch.on[,7] = rep('on',15) 

colnames(average.switch.on) = c('CBF1','GAL4','SWI5','GAL80','ASH1','time', 'switch')




# Switch-Off Data
average.switch.off = as.data.frame(matrix(,nrow= 20,ncol = 6))

#CBF1
average.switch.off[,1] = c(0.0419, 0.0365, 0.0514, 0.0473, 0.0482, 0.0546, 0.0648, 0.0552, 0.0497, 0.0352, 0.0358, 0.0338, 0.0309, 0.0232, 0.0191, 0.0190 , 0.0176, 0.0105, 0.0081, 0.0072)

#GAL4
average.switch.off[,2] = c(0.0207, 0.0122, 0.0073, 0.0079, 0.0084, 0.0100, 0.0096, 0.0107, 0.0113, 0.0116, 0.0073, 0.0075, 0.0082, 0.0078, 0.0089, 0.0104, 0.0114, 0.0100, 0.0086, 0.0078)

#SWI5
average.switch.off[,3] = c(0.0760, 0.0186, 0.0090, 0.0117 ,0.0088, 0.0095, 0.0075, 0.0070, 0.0081, 0.0057 ,0.0052, 0.0093, 0.0055, 0.0060, 0.0069, 0.0093, 0.0090, 0.0129, 0.0022, 0.0018)

#GAL80
average.switch.off[,4] = c(0.0225, 0.0175, 0.0165, 0.0147, 0.0145, 0.0144, 0.0106, 0.0119, 0.0104, 0.0142, 0.0084, 0.0097, 0.0088, 0.0087, 0.0086, 0.0110, 0.0124, 0.0093, 0.0079, 0.0103)

#ASH1
average.switch.off[,5] = c(0.1033, 0.0462, 0.0439, 0.0371, 0.0475, 0.0468, 0.0347, 0.0247, 0.0269, 0.0190, 0.0134, 0.0148, 0.0101, 0.0088, 0.0080, 0.0090, 0.0113, 0.0154, 0.0030, 0.0012)

#time
average.switch.off[,6] = c(0:19)*10

#classes
average.switch.off[,7] = rep('off',20) 


colnames(average.switch.off) = c('CBF1','GAL4','SWI5','GAL80','ASH1','time', 'switch')

# Corrupt Average data
corrupt.average.data = rbind(average.switch.on,average.switch.off)     #
yeast.data.list$corrupt.average = corrupt.average.data

 
